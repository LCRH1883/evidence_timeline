<Window x:Class="evidence_timeline.Views.EvidenceWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Evidence Details"
        Height="600"
        Width="900"
        MinHeight="500"
        MinWidth="700"
        ResizeMode="CanResizeWithGrip">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" Margin="12">
            <TextBlock Text="Title:" VerticalAlignment="Center" />
            <TextBox Width="280"
                     Margin="6 0 12 0"
                     Text="{Binding Evidence.Title, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     KeyDown="OnMetadataEnterKey"
                     LostFocus="OnMetadataFieldLostFocus" />
            <TextBlock Text="Court #:" VerticalAlignment="Center" />
            <TextBox Width="160"
                     Margin="6 0 12 0"
                     Text="{Binding Evidence.CourtNumber, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     KeyDown="OnMetadataEnterKey"
                     LostFocus="OnMetadataFieldLostFocus" />
            <Button Content="Save"
                    Width="80"
                    Command="{Binding SaveCommand}" />
        </StackPanel>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*" />
                <ColumnDefinition Width="2*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="200" />
            </Grid.RowDefinitions>

            <!-- Metadata -->
            <ScrollViewer Grid.Column="1" Margin="8" VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <TextBlock Text="Type" FontWeight="Bold" />
                    <ComboBox ItemsSource="{Binding Types}"
                              DisplayMemberPath="Name"
                              SelectedValuePath="Id"
                              SelectedValue="{Binding Evidence.TypeId, Mode=TwoWay}"
                              Margin="0 2 0 8"
                              SelectionChanged="OnMetadataSelectionChanged" />

                    <TextBlock Text="Tags" FontWeight="Bold" />
                    <ItemsControl ItemsSource="{Binding TagOptions}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <CheckBox Content="{Binding Name}"
                                          IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                          Checked="OnMetadataCheckboxChanged"
                                          Unchecked="OnMetadataCheckboxChanged" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <TextBlock Text="People" FontWeight="Bold" Margin="0 8 0 0" />
                    <ItemsControl ItemsSource="{Binding PersonOptions}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <CheckBox Content="{Binding Name}"
                                          IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                          Checked="OnMetadataCheckboxChanged"
                                          Unchecked="OnMetadataCheckboxChanged" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <TextBlock Text="Linked evidence" FontWeight="Bold" Margin="0 8 0 0" />
                    <ItemsControl ItemsSource="{Binding LinkedEvidence}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding}" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <TextBlock Text="Attachments" FontWeight="Bold" Margin="0 8 0 4" />
                    <ItemsControl ItemsSource="{Binding Evidence.Attachments}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding FileName}" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </ScrollViewer>

            <!-- Notes -->
            <Grid Grid.Column="0" Grid.RowSpan="2" Margin="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <StackPanel Orientation="Horizontal" Margin="0 0 0 8">
                    <TextBlock Text="Notes" FontWeight="Bold" VerticalAlignment="Center" />
                    <Button Content="Save Notes"
                            Margin="8 0 0 0"
                            Command="{Binding SaveNotesCommand}" />
                </StackPanel>
                <TextBox Grid.Row="1"
                         Text="{Binding NotesText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         AcceptsReturn="True"
                         VerticalScrollBarVisibility="Auto" />
            </Grid>

            <!-- Date -->
            <StackPanel Grid.Column="1" Grid.Row="1" Margin="8">
                <TextBlock Text="Date mode" FontWeight="Bold" />
                <ComboBox SelectedValue="{Binding Evidence.DateInfo.Mode, Mode=TwoWay}"
                          SelectedValuePath="Tag"
                          SelectionChanged="OnMetadataSelectionChanged">
                    <ComboBoxItem Content="Exact" Tag="Exact" />
                    <ComboBoxItem Content="Around" Tag="Around" />
                    <ComboBoxItem Content="Broad" Tag="Broad" />
                </ComboBox>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
